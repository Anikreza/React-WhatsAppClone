(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{72:function(e,a,t){},73:function(e,a,t){},74:function(e,a,t){},75:function(e,a,t){},90:function(e,a,t){},93:function(e,a,t){},94:function(e,a,t){"use strict";t.r(a);var c=t(1),s=t.n(c),n=t(31),i=t.n(n),r=(t(72),t(8)),o=(t(73),t(74),t(115)),l=t(110),d=t(57),j=t.n(d),m=t(58),b=t.n(m),u=t(59),h=t.n(u),O=t(111),p=(t(75),t(28)),f=p.a.initializeApp({apiKey:"AIzaSyCYmU-SnsQxAGOpnFFhcR5khqHbo3XH_FI",authDomain:"whatsappclone-ba70f.firebaseapp.com",projectId:"whatsappclone-ba70f",storageBucket:"whatsappclone-ba70f.appspot.com",messagingSenderId:"504204411802",appId:"1:504204411802:web:7e96ba30cd343b3d0d7023",measurementId:"G-HHC2HRPXGP"}),x=f.firestore(),v=f.auth(),g=new p.a.auth.GoogleAuthProvider,N=p.a.storage(),S=(p.a.firestore.FieldValue.serverTimestamp,x),w=t(36),y=t(5),k=Object(c.createContext)(),C=function(e){var a=e.reducer,t=e.initialState,s=e.children;return Object(y.jsx)(k.Provider,{value:Object(c.useReducer)(a,t),children:s})},F=function(){return Object(c.useContext)(k)};var E=function(e){var a,t=e.addChat,s=e.name,n=e.id,i=Object(c.useState)(" "),l=Object(r.a)(i,2),d=l[0],j=l[1],m=Object(c.useState)(""),b=Object(r.a)(m,2),u=b[0],h=b[1],O=F(),p=Object(r.a)(O,2),f=p[0].user;return p[1],Object(c.useEffect)((function(){n&&S.collection("rooms").doc(n).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){j(e.docs.map((function(e){return e.data()})))}))}),[n]),Object(c.useEffect)((function(){h(Math.floor(5e3*Math.random()))}),[]),t?Object(y.jsx)("div",{onClick:function(){var e=null===f||void 0===f?void 0:f.displayName;e&&S.collection("rooms").add({name:e,user:f.email})},className:"sidebar-chat",children:Object(y.jsx)("h2",{children:" Add New Chat"})}):Object(y.jsx)(w.b,{to:"/rooms/".concat(n),children:Object(y.jsxs)("div",{className:"sidebar-chat",children:[Object(y.jsx)(o.a,{src:"https://avatars.dicebear.com/api/initials/".concat(u,".svg")}),Object(y.jsxs)("div",{className:"sidebar-chat-info ".concat("tanvirrezaanik@gmail.com"!==f.email&&"jainfariha@gmail.com"!==f.email&&"anikreza22@gmail.com"!==f.email&&"sagar.alpha@gmail.com"!==f.email&&"hidden-photo"),children:[Object(y.jsxs)("h2",{children:["  ",s,"'s Room"]}),Object(y.jsx)("p",{children:null===(a=d[0])||void 0===a?void 0:a.message})]})]})})},I=function(){var e=F(),a=Object(r.a)(e,2),t=a[0].user,s=(a[1],Object(c.useState)([])),n=Object(r.a)(s,2),i=n[0],d=n[1];return Object(c.useEffect)((function(){var e=S.collection("rooms").onSnapshot((function(e){return d(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(y.jsxs)("div",{className:"sidebar",children:[Object(y.jsxs)("div",{className:"sidebar-header",children:[Object(y.jsx)(o.a,{src:t.photoURL}),Object(y.jsxs)("div",{className:"sidebar-header-right",children:[Object(y.jsx)(l.a,{children:Object(y.jsx)(j.a,{})}),Object(y.jsx)(l.a,{children:Object(y.jsx)(b.a,{})}),Object(y.jsx)(l.a,{children:Object(y.jsx)(h.a,{})})]})]}),Object(y.jsx)("div",{className:"sidebar-search",children:Object(y.jsxs)("div",{className:"sidebar-searchContainer",children:[Object(y.jsx)(O.a,{}),Object(y.jsx)("input",{placeholder:"start a new chat",type:"text"})]})}),Object(y.jsxs)("div",{className:"sidebar-chatlist",children:[Object(y.jsx)(E,{addChat:!0}),i.map((function(e){return Object(y.jsx)(E,{id:e.id,name:e.data.name},e.id)}))]})]})},R=t(23),T=t.n(R),z=t(33),A=(t(90),t.p,t.p+"static/media/as.768863f9.jpg"),P=t(112),L=t(113),B=t(61),D=t.n(B),G=t(12),H=t(51),U=t.n(H),W=(t(92),t(60)),_=function(){Object(c.useRef)();var e,a,t=F(),s=Object(r.a)(t,2),n=s[0].user,i=(s[1],Object(c.useState)("")),d=Object(r.a)(i,2),j=(d[0],d[1],Object(G.f)().roomId),m=Object(c.useState)(""),b=Object(r.a)(m,2),u=b[0],h=b[1],f=Object(c.useState)([]),x=Object(r.a)(f,2),v=x[0],g=x[1],w=Object(c.useState)(" "),k=Object(r.a)(w,2),C=k[0],E=k[1],I=Object(c.useState)(""),R=Object(r.a)(I,2),B=R[0],H=R[1],_=Object(c.useState)(""),M=Object(r.a)(_,2),V=(M[0],M[1]),J=Object(c.useState)(0),X=Object(r.a)(J,2),q=(X[0],X[1]),K=Object(c.useState)(""),Q=Object(r.a)(K,2),Y=Q[0],Z=Q[1];Object(c.useEffect)((function(){S.collection("rooms").doc(j).onSnapshot((function(e){h(e.data().name)})),S.collection("rooms").doc(j).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){g(e.docs.map((function(e){return e.data()})))}))}),[j]),Object(c.useEffect)((function(){B&&$.put(C).on("state_changed",(function(e){var a=e.bytesTransferred/e.totalBytes*100;q(a)}),(function(e){V(e)}),Object(z.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.collection("rooms").doc(j).collection("messages").add({timestamp:p.a.firestore.FieldValue.serverTimestamp(),image:B,name:null===n||void 0===n?void 0:n.displayName}),H("");case 2:case"end":return e.stop()}}),e)}))))}),[B]);var $=N.ref("images/".concat(C.name)),ee=function(){var e=Object(z.a)(T.a.mark((function e(a){var t,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.target.files[0])){e.next=9;break}return c=new FileReader,e.next=5,E(t);case 5:c.onloadend=function(){H(c.result)},c.readAsDataURL(t),e.next=11;break;case 9:E(null),V("Please select an image file");case 11:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return Object(y.jsxs)("div",{className:"chat",children:[Object(y.jsxs)("div",{className:"chat-header",children:[Object(y.jsx)(o.a,{src:n.photoURL}),Object(y.jsxs)("div",{className:"chat-header-info",children:[Object(y.jsx)("h3",{children:u}),Object(y.jsxs)("p",{children:["Last Active ."," ",U()(null===(e=v[v.length-1])||void 0===e||null===(a=e.timestamp)||void 0===a?void 0:a.toDate()).startOf("minute").fromNow()]})]}),Object(y.jsxs)("div",{className:"chat-header-right",children:[Object(y.jsx)(l.a,{children:Object(y.jsx)(O.a,{})}),Object(y.jsx)(l.a,{children:Object(y.jsxs)("label",{htmlFor:"image",children:[Object(y.jsx)(P.a,{style:{cursor:"pointer"}}),Object(y.jsx)("input",{type:"file",onChange:ee,id:"image",style:{display:"none"}})]})}),Object(y.jsx)(l.a,{children:Object(y.jsx)(L.a,{})})]})]}),Object(y.jsxs)("div",{className:"chat-body ".concat("tanvirrezaanik@gmail.com"!==n.email&&"jainfariha@gmail.com"!==n.email&&"anikreza22@gmail.com"!==n.email&&"sagar.alpha@gmail.com"!==n.email&&"hidden-photo"),children:[Object(y.jsx)("div",{className:"show".concat("tanvirrezaanik@gmail.com"===n.email&&"jainfariha@gmail.com"===n.email&&"anikreza22@gmail.com"===n.email&&"sagar.alpha@gmail.com"===n.email&&"hidden"),children:Object(y.jsx)("img",{src:A,width:"100%",height:"430px"})}),v.map((function(e){var a;return Object(y.jsxs)("p",{className:"message ".concat(e.name===n.displayName&&"reciever"),children:[e.message," ",Object(y.jsx)("img",{className:"media",src:e.image}),Object(y.jsxs)("span",{className:"sender-name",children:[" ",e.name," "]}),Object(y.jsxs)("span",{className:"emoti",children:[" ",e.emoti," "]}),Object(y.jsx)("span",{className:"timestamp",children:U()(null===(a=v.timestamp)||void 0===a?void 0:a.toDate()).format("LT")})]})}))]}),Object(y.jsxs)("div",{className:"chat-footer",children:[Object(y.jsx)(D.a,{}),Object(y.jsx)(W.a,{value:Y,onChange:Z,cleanOnEnter:!0,onEnter:function(){Y&&(S.collection("rooms").doc(j).collection("messages").add({message:Y,name:null===n||void 0===n?void 0:n.displayName,timestamp:p.a.firestore.FieldValue.serverTimestamp()}),Z(""))},placeholder:"Type a message",borderRadius:"20"})]})]})},M=t(62),V=(t(93),t(114)),J=t(34),X="SET_USER",q=function(e,a){switch(a.type){case X:return Object(J.a)(Object(J.a)({},e),{},{user:a.user});default:return e}},K=function(){var e=F(),a=Object(r.a)(e,2);Object(M.a)(a[0]);var t=a[1];return Object(y.jsx)("div",{className:"login",children:Object(y.jsxs)("div",{className:"login-container",children:[Object(y.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",alt:""}),Object(y.jsx)("div",{className:"login_text",children:Object(y.jsx)("h1",{children:"Sign in to Whatsapp"})}),Object(y.jsx)(V.a,{type:"submit",onClick:function(){v.signInWithPopup(g).then((function(e){return t({type:X,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in With Google"})]})})};var Q=function(){var e=F(),a=Object(r.a)(e,2),t=a[0].user;return a[1],Object(c.useEffect)((function(){t&&S.collection("users").doc(t.uid).set({user:t.email,token:t.refreshToken})}),[]),Object(y.jsx)("div",{className:"app",children:t?Object(y.jsx)("div",{className:"app-container",children:Object(y.jsxs)(w.a,{children:[Object(y.jsx)(I,{}),Object(y.jsxs)(G.c,{children:[Object(y.jsx)(G.a,{path:"/rooms/:roomId",children:Object(y.jsx)(_,{})}),Object(y.jsx)(G.a,{path:"/",children:Object(y.jsx)("h1",{})})]})]})}):Object(y.jsx)(K,{})})},Y=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,116)).then((function(a){var t=a.getCLS,c=a.getFID,s=a.getFCP,n=a.getLCP,i=a.getTTFB;t(e),c(e),s(e),n(e),i(e)}))};i.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(C,{initialState:{user:null},reducer:q,children:Object(y.jsx)(Q,{})})}),document.getElementById("root")),Y()}},[[94,1,2]]]);
//# sourceMappingURL=main.320cffea.chunk.js.map