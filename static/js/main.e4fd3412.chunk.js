(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},90:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){"use strict";a.r(t);var c=a(2),n=a.n(c),s=a(30),i=a.n(s),r=(a(72),a(10)),o=(a(73),a(74),a(113)),l=a(108),d=a(56),j=a.n(d),u=a(57),b=a.n(u),m=a(58),h=a.n(m),O=a(109),p=(a(75),a(25)),f=p.a.initializeApp({apiKey:"AIzaSyCYmU-SnsQxAGOpnFFhcR5khqHbo3XH_FI",authDomain:"whatsappclone-ba70f.firebaseapp.com",projectId:"whatsappclone-ba70f",storageBucket:"whatsappclone-ba70f.appspot.com",messagingSenderId:"504204411802",appId:"1:504204411802:web:7e96ba30cd343b3d0d7023",measurementId:"G-HHC2HRPXGP"}),x=f.firestore(),v=f.auth(),g=new p.a.auth.GoogleAuthProvider,S=p.a.storage(),N=p.a.firestore.FieldValue.serverTimestamp,y=x,w=a(36),C=a(4);var k=function(e){var t,a=e.addChat,n=e.name,s=e.id,i=Object(c.useState)(" "),l=Object(r.a)(i,2),d=l[0],j=l[1],u=Object(c.useState)(""),b=Object(r.a)(u,2),m=b[0],h=b[1];return Object(c.useEffect)((function(){s&&y.collection("rooms").doc(s).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){j(e.docs.map((function(e){return e.data()})))}))}),[s]),Object(c.useEffect)((function(){h(Math.floor(5e3*Math.random()))}),[]),a?Object(C.jsx)("div",{onClick:function(){var e=prompt("add new chat");e&&y.collection("rooms").add({name:e})},className:"sidebar-chat",children:Object(C.jsx)("h2",{children:" Add New Chat"})}):Object(C.jsx)(w.b,{to:"/rooms/".concat(s),children:Object(C.jsxs)("div",{className:"sidebar-chat",children:[Object(C.jsx)(o.a,{src:"https://avatars.dicebear.com/api/initials/".concat(m,".svg")}),Object(C.jsxs)("div",{className:"sidebar-chat-info",children:[Object(C.jsxs)("h2",{children:["  ",n]}),Object(C.jsx)("p",{children:null===(t=d[0])||void 0===t?void 0:t.message})]})]})})},F=Object(c.createContext)(),I=function(e){var t=e.reducer,a=e.initialState,n=e.children;return Object(C.jsx)(F.Provider,{value:Object(c.useReducer)(t,a),children:n})},T=function(){return Object(c.useContext)(F)},D=function(){var e=T(),t=Object(r.a)(e,2),a=t[0].user,n=(t[1],Object(c.useState)([])),s=Object(r.a)(n,2),i=s[0],d=s[1];return Object(c.useEffect)((function(){var e=y.collection("rooms").onSnapshot((function(e){return d(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(C.jsxs)("div",{className:"sidebar",children:[Object(C.jsxs)("div",{className:"sidebar-header",children:[Object(C.jsx)(o.a,{src:a.photoURL}),Object(C.jsxs)("div",{className:"sidebar-header-right",children:[Object(C.jsx)(l.a,{children:Object(C.jsx)(j.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(b.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(h.a,{})})]})]}),Object(C.jsx)("div",{className:"sidebar-search",children:Object(C.jsxs)("div",{className:"sidebar-searchContainer",children:[Object(C.jsx)(O.a,{}),Object(C.jsx)("input",{placeholder:"start a new chat",type:"text"})]})}),Object(C.jsxs)("div",{className:"sidebar-chatlist",children:[Object(C.jsx)(k,{addChat:!0}),i.map((function(e){return Object(C.jsx)(k,{id:e.id,name:e.data.name},e.id)}))]})]})},E=a(29),P=a.n(E),A=a(45),B=(a(90),a.p+"static/media/aa.14327386.jpg"),R=a(110),L=a(111),U=a(61),G=a.n(U),H=a(60),_=a.n(H),M=a(11),V=a(59),W=a.n(V),z=function(){var e,t,a=T(),n=Object(r.a)(a,2),s=n[0].user,i=(n[1],Object(M.f)().roomId),d=Object(c.useState)(""),j=Object(r.a)(d,2),u=j[0],b=j[1],m=Object(c.useState)([]),h=Object(r.a)(m,2),f=h[0],x=h[1],v=Object(c.useState)(" "),g=Object(r.a)(v,2),w=g[0],k=g[1],F=Object(c.useState)(""),I=Object(r.a)(F,2),D=I[0],E=I[1],U=Object(c.useState)(""),H=Object(r.a)(U,2),V=(H[0],H[1]),z=Object(c.useState)(""),J=Object(r.a)(z,2),X=(J[0],J[1]),q=Object(c.useState)(0),K=Object(r.a)(q,2),Q=(K[0],K[1]);Object(c.useEffect)((function(){y.collection("rooms").doc(i).onSnapshot((function(e){b(e.data().name)})),y.collection("rooms").doc(i).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){x(e.docs.map((function(e){return e.data()})))}))}),[i]);var Y=function(){var e=Object(A.a)(P.a.mark((function e(t){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.files[0]){e.next=6;break}return e.next=3,k(t.target.files[0]);case 3:alert("Click Send"),e.next=8;break;case 6:k(null),V("Please select an image file");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){Z.put(w).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;Q(t)}),(function(e){V(e)}),Object(A.a)(P.a.mark((function e(){var t,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getDownloadURL();case 2:t=e.sent,a=N(),E(t),alert(D),X(a),y.collection("rooms").doc(i).collection("messages").add({timestamp:p.a.firestore.FieldValue.serverTimestamp(),image:D,name:null===s||void 0===s?void 0:s.displayName}),k(" ");case 9:case"end":return e.stop()}}),e)}))))}),[w]);var Z=S.ref("images/".concat(w.name));console.log(D);var $=Object(c.useState)(""),ee=Object(r.a)($,2),te=ee[0],ae=ee[1];return console.log(te),Object(C.jsxs)("div",{className:"chat",children:[Object(C.jsxs)("div",{className:"chat-header",children:[Object(C.jsx)(o.a,{src:B}),Object(C.jsxs)("div",{className:"chat-header-info",children:[Object(C.jsx)("h3",{children:u}),Object(C.jsxs)("p",{children:["Last Active ."," ",W()(null===(e=f[f.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).startOf("minute").fromNow()]})]}),Object(C.jsxs)("div",{className:"chat-header-right",children:[Object(C.jsx)(l.a,{children:Object(C.jsx)(O.a,{})}),Object(C.jsx)(l.a,{children:Object(C.jsxs)("label",{htmlFor:"image",children:[Object(C.jsx)(R.a,{style:{cursor:"pointer"}}),Object(C.jsx)("input",{type:"file",onChange:Y,id:"image",style:{display:"none"}})]})}),Object(C.jsx)(l.a,{children:Object(C.jsx)(L.a,{})})]})]}),Object(C.jsx)("div",{className:"chat-body",children:f.map((function(e){var t;return Object(C.jsxs)("p",{className:"message ".concat(e.name===s.displayName&&"reciever"),children:[e.message," ",Object(C.jsx)("img",{className:"media",src:e.image}),Object(C.jsxs)("span",{className:"sender-name",children:[" ",e.name]}),Object(C.jsx)("span",{className:"timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(C.jsxs)("div",{className:"chat-footer",children:[Object(C.jsx)(_.a,{}),Object(C.jsx)("img",{src:D,style:{width:"20px",height:"20px"}}),Object(C.jsxs)("form",{onSubmit:function(e){return e.preventDefault},children:[Object(C.jsx)("input",{value:te,type:"text",placeholder:"Type a message",onChange:function(e){return ae(e.target.value)}}),Object(C.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),y.collection("rooms").doc(i).collection("messages").add({message:te,name:null===s||void 0===s?void 0:s.displayName,timestamp:p.a.firestore.FieldValue.serverTimestamp()}),ae(" ")},children:" Send a Message"})]}),Object(C.jsx)("button",{type:"submit",onClick:function(){Z.put(w).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;Q(t)}),(function(e){V(e)}),Object(A.a)(P.a.mark((function e(){var t,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getDownloadURL();case 2:t=e.sent,a=N(),E(t),alert(D),X(a),y.collection("rooms").doc(i).collection("messages").add({timestamp:p.a.firestore.FieldValue.serverTimestamp(),image:D,name:null===s||void 0===s?void 0:s.displayName});case 8:case"end":return e.stop()}}),e)}))))},children:" Send Image "}),Object(C.jsx)(G.a,{})]}),console.log(w.name)]})},J=a(62),X=(a(92),a(112)),q=a(50),K="SET_USER",Q=function(e,t){switch(t.type){case K:return Object(q.a)(Object(q.a)({},e),{},{user:t.user});default:return e}},Y=function(){var e=T(),t=Object(r.a)(e,2);Object(J.a)(t[0]);var a=t[1];return Object(C.jsx)("div",{className:"login",children:Object(C.jsxs)("div",{className:"login-container",children:[Object(C.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",alt:""}),Object(C.jsx)("div",{className:"login_text",children:Object(C.jsx)("h1",{children:"Sign in to Whatsapp"})}),Object(C.jsx)(X.a,{type:"submit",onClick:function(){v.signInWithPopup(g).then((function(e){return a({type:K,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in With Google"})]})})};var Z=function(){var e=T(),t=Object(r.a)(e,2),a=t[0].user;return t[1],Object(C.jsx)("div",{className:"app",children:a?Object(C.jsx)("div",{className:"app-container",children:Object(C.jsxs)(w.a,{children:[Object(C.jsx)(D,{}),Object(C.jsxs)(M.c,{children:[Object(C.jsx)(M.a,{path:"/rooms/:roomId",children:Object(C.jsx)(z,{})}),Object(C.jsx)(M.a,{path:"/",children:Object(C.jsx)("h1",{})})]})]})}):Object(C.jsx)(Y,{})})},$=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,114)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),c(e),n(e),s(e),i(e)}))};i.a.render(Object(C.jsx)(n.a.StrictMode,{children:Object(C.jsx)(I,{initialState:{user:null},reducer:Q,children:Object(C.jsx)(Z,{})})}),document.getElementById("root")),$()}},[[93,1,2]]]);
//# sourceMappingURL=main.e4fd3412.chunk.js.map