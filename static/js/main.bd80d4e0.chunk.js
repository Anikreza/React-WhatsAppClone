(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{70:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},87:function(e,t,c){},89:function(e,t,c){},90:function(e,t,c){"use strict";c.r(t);var a=c(2),s=c.n(a),n=c(28),i=c.n(n),r=(c(70),c(14)),o=(c(71),c(72),c(109)),j=c(104),d=c(54),l=c.n(d),b=c(55),h=c.n(b),u=c(56),O=c.n(u),m=c(105),p=(c(73),c(39)),x=p.a.initializeApp({apiKey:"AIzaSyCYmU-SnsQxAGOpnFFhcR5khqHbo3XH_FI",authDomain:"whatsappclone-ba70f.firebaseapp.com",projectId:"whatsappclone-ba70f",storageBucket:"whatsappclone-ba70f.appspot.com",messagingSenderId:"504204411802",appId:"1:504204411802:web:7e96ba30cd343b3d0d7023",measurementId:"G-HHC2HRPXGP"}),f=x.firestore(),v=x.auth(),g=new p.a.auth.GoogleAuthProvider,N=f,S=c(34),w=c(4);var C=function(e){var t,c=e.addChat,s=e.name,n=e.id,i=Object(a.useState)(" "),j=Object(r.a)(i,2),d=j[0],l=j[1],b=Object(a.useState)(""),h=Object(r.a)(b,2),u=h[0],O=h[1];return Object(a.useEffect)((function(){n&&N.collection("rooms").doc(n).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){l(e.docs.map((function(e){return e.data()})))}))}),[n]),Object(a.useEffect)((function(){O(Math.floor(5e3*Math.random()))}),[]),c?Object(w.jsx)("div",{onClick:function(){var e=prompt("add new chat");e&&N.collection("rooms").add({name:e})},className:"sidebar-chat",children:Object(w.jsx)("h2",{children:" Add New Chat"})}):Object(w.jsx)(S.b,{to:"/rooms/".concat(n),children:Object(w.jsxs)("div",{className:"sidebar-chat",children:[Object(w.jsx)(o.a,{src:"https://avatars.dicebear.com/api/micah/".concat(u,".svg")}),Object(w.jsxs)("div",{className:"sidebar-chat-info",children:[Object(w.jsxs)("h2",{children:["  ",s]}),Object(w.jsx)("p",{children:null===(t=d[0])||void 0===t?void 0:t.message})]})]})})},y=Object(a.createContext)(),I=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(w.jsx)(y.Provider,{value:Object(a.useReducer)(t,c),children:s})},k=function(){return Object(a.useContext)(y)},F=function(){var e=k(),t=Object(r.a)(e,2),c=t[0].user,s=(t[1],Object(a.useState)([])),n=Object(r.a)(s,2),i=n[0],d=n[1];return Object(a.useEffect)((function(){var e=N.collection("rooms").onSnapshot((function(e){return d(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(w.jsxs)("div",{className:"sidebar",children:[Object(w.jsxs)("div",{className:"sidebar-header",children:[Object(w.jsx)(o.a,{src:c.photoURL}),Object(w.jsxs)("div",{className:"sidebar-header-right",children:[Object(w.jsx)(j.a,{children:Object(w.jsx)(l.a,{})}),Object(w.jsx)(j.a,{children:Object(w.jsx)(h.a,{})}),Object(w.jsx)(j.a,{children:Object(w.jsx)(O.a,{})})]})]}),Object(w.jsx)("div",{className:"sidebar-search",children:Object(w.jsxs)("div",{className:"sidebar-searchContainer",children:[Object(w.jsx)(m.a,{}),Object(w.jsx)("input",{placeholder:"start a new chat",type:"text"})]})}),Object(w.jsxs)("div",{className:"sidebar-chatlist",children:[Object(w.jsx)(C,{addChat:!0}),i.map((function(e){return Object(w.jsx)(C,{id:e.id,name:e.data.name},e.id)}))]})]})},D=(c(87),c.p+"static/media/aa.14327386.jpg"),E=c(106),P=c(107),A=c(59),T=c.n(A),B=c(58),G=c.n(B),H=c(10),R=c(57),L=c.n(R),M=function(){var e,t,c=k(),s=Object(r.a)(c,2),n=s[0].user,i=(s[1],Object(H.f)().roomId),d=Object(a.useState)(""),l=Object(r.a)(d,2),b=l[0],h=l[1],u=Object(a.useState)([]),O=Object(r.a)(u,2),x=O[0],f=O[1];Object(a.useEffect)((function(){N.collection("rooms").doc(i).onSnapshot((function(e){h(e.data().name)})),N.collection("rooms").doc(i).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){f(e.docs.map((function(e){return e.data()})))}))}),[i]);var v=Object(a.useState)(""),g=Object(r.a)(v,2),S=g[0],C=g[1];return console.log(S),Object(w.jsxs)("div",{className:"chat",children:[Object(w.jsxs)("div",{className:"chat-header",children:[Object(w.jsx)(o.a,{src:D}),Object(w.jsxs)("div",{className:"chat-header-info",children:[Object(w.jsx)("h3",{children:b}),Object(w.jsxs)("p",{children:["Last Seen ."," ",L()(null===(e=x[x.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).startOf("minute").fromNow()]})]}),Object(w.jsxs)("div",{className:"chat-header-right",children:[Object(w.jsx)(j.a,{children:Object(w.jsx)(m.a,{})}),Object(w.jsx)(j.a,{children:Object(w.jsx)(E.a,{})}),Object(w.jsx)(j.a,{children:Object(w.jsx)(P.a,{})})]})]}),Object(w.jsx)("div",{className:"chat-body",children:x.map((function(e){var t;return Object(w.jsxs)("p",{className:"message ".concat(e.name===n.displayName&&"reciever"),children:[e.message,Object(w.jsxs)("span",{className:"sender-name",children:[" ",e.name]}),Object(w.jsx)("span",{className:"timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(w.jsxs)("div",{className:"chat-footer",children:[Object(w.jsx)(G.a,{}),Object(w.jsxs)("form",{onSubmit:function(e){return e.preventDefault},children:[Object(w.jsx)("input",{value:S,type:"text",placeholder:"Type a message",onChange:function(e){return C(e.target.value)}}),Object(w.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),N.collection("rooms").doc(i).collection("messages").add({message:S,name:null===n||void 0===n?void 0:n.displayName,timestamp:p.a.firestore.FieldValue.serverTimestamp()}),C(" ")},children:" Send a Message"})]}),Object(w.jsx)(T.a,{})]})]})},U=c(60),W=(c(89),c(108)),_=c(48),z="SET_USER",J=function(e,t){switch(t.type){case z:return Object(_.a)(Object(_.a)({},e),{},{user:t.user});default:return e}},X=function(){var e=k(),t=Object(r.a)(e,2);Object(U.a)(t[0]);var c=t[1];return Object(w.jsx)("div",{className:"login",children:Object(w.jsxs)("div",{className:"login-container",children:[Object(w.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",alt:""}),Object(w.jsx)("div",{className:"login_text",children:Object(w.jsx)("h1",{children:"Sign in to Whatsapp"})}),Object(w.jsx)(W.a,{type:"submit",onClick:function(){v.signInWithPopup(g).then((function(e){return c({type:z,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in With Google"})]})})};var q=function(){var e=k(),t=Object(r.a)(e,2),c=t[0].user;return t[1],Object(w.jsx)("div",{className:"app",children:c?Object(w.jsx)("div",{className:"app-container",children:Object(w.jsxs)(S.a,{children:[Object(w.jsx)(F,{}),Object(w.jsxs)(H.c,{children:[Object(w.jsx)(H.a,{path:"/rooms/:roomId",children:Object(w.jsx)(M,{})}),Object(w.jsx)(H.a,{path:"/",children:Object(w.jsx)("h1",{})})]})]})}):Object(w.jsx)(X,{})})},K=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,110)).then((function(t){var c=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;c(e),a(e),s(e),n(e),i(e)}))};i.a.render(Object(w.jsx)(s.a.StrictMode,{children:Object(w.jsx)(I,{initialState:{user:null},reducer:J,children:Object(w.jsx)(q,{})})}),document.getElementById("root")),K()}},[[90,1,2]]]);
//# sourceMappingURL=main.bd80d4e0.chunk.js.map